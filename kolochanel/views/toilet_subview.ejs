<script>
    function openDialog_1() {
        document.getElementById("submitfield_1").click();
    }
    function openDialog_2() {
        document.getElementById("submitfield_2").click();
    }
    function openDialog_3() {
        document.getElementById("submitfield_3").click();
    }
    function addToilet() {
        document.getElementById("addshitter").submit();
    }

    document.getElementById("submitbutton_1").addEventListener('click', openDialog_1);
    document.getElementById("submitbutton_2").addEventListener('click', openDialog_2);
    document.getElementById("submitbutton_3").addEventListener('click', openDialog_3);

    function killimage(imgroup, imid) {
        console.log("kill", imgroup, imid)
        document.getElementById("killimage_boxtarget").value = imgroup;
        document.getElementById("killimage_imtarget").value = imid;
        document.getElementById("killimage").submit();
    }
</script>

<% if(tref == "None") { %>

<% } else if(tref == "Invite") { %>
    <div class="p-2 nested_toilet_subview-box" style = "max-width: 33%;">
        <!--
        <img class="p-1 img-responsive" src="/images/add_new_box.jpg" style="width: 100%;" onclick="addToilet()">
-->
        <p> Dodaj nową toaletę</p>
        <form action="/userpage/addshitter/username/<%= username %>" id="addshitter" method="post">
            <input class="form-control" name="toilet_name" type="text" placeholder="Nazwa" aria-label="default input example">
            <input class="form-control" name="toilet_desc" type="text" placeholder="Opis" aria-label="default input example">
            <input class="form-control" name="toilet_GPS" type="text" placeholder="KoordynatyGPS" aria-label="default input example">
            <button type="submit" class="w-100 btn btn-primary">Dodaj Toaletę</button>
        </form>
    </div>
<% } else { %>
    <div class="p-2 nested_toilet_subview-box" style = "width: 33%;">
        <h4 class="p-2"><%= tref.toiletname %></h4>
        <% if(tref.toiletdesc) { %>
            <h6 class="p-2"><%= tref.toiletdesc %></h6>
        <% } %>
        <div class="d-flex flex-row bd-highlight mb-3" style="flex-wrap:wrap">
            <% for(var i=0; i < tref.toiletimages.length; i++) { %>
                <% if (tref.toiletimages[i] == "add_new") { %>
                    <% if (interactive_page == true) { %>
                        <img class="p-1 img-responsive" src="/images/add_new_box.jpg" onclick="openDialog()" style="width: 33%;" id="submitbutton_<%=imgroup%>">

                        <form action="/userpage/addimage/username/<%= username %>/toiletgroup/<%= imgroup %>" method="post" enctype="multipart/form-data">
                            <input type="file" name="toiletimage" id="submitfield_<%=imgroup%>" onchange="this.form.submit();" hidden/>
                        </form>
                    <% } else { %>
                        <img class="p-1 img-responsive" src="/images/empty_box.jpg" style="width: 33%;">
                    <% } %>
                <% } else if (tref.toiletimages[i] == "empty") { %>
                    <img class="p-1 img-responsive" src="/images/empty_box.jpg" style="width: 33%;">
                <% } else { %>
                    <form style="position:absolute" action="/userpage/killimage/username/<%= username %>" id="killimage" method="post" hidden>
                        <input class="form-control" name="killimage_boxtarget" id="killimage_boxtarget" type="text" hidden>
                        <input class="form-control" name="killimage_imtarget" id="killimage_imtarget" type="text" hidden>
                    </form>
                    <div class="p-1 img-responsive" style="width: 33%;">
                        <img class="p-1 img-responsive" style="width: 100%;" src="<%= tref.toiletimages[i] %>">
                        <% if (interactive_page == true) { %>   <!-- to rzuca błędami lintera, ale działa (tm)-->
                            <img style="position:absolute; height: 1.5rem; translate: 330% -430%;" onclick="killimage(<%=imgroup%>, 1+<%=i%>);" src="/images/icons/trash-fill.svg">
                        <% } %>    
                    </div>
                <% } %>
            <% } %>
        </div>
    </div>
<% } %>